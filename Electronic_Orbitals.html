<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GLTF File Importer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
        }

        #app-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            position: relative;
        }

        #viewer-container {
            flex-grow: 1;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        canvas {
            display: block;
        }

        .controls-container {
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            z-index: 10;
        }

        .button-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 8px;
            background-color: rgba(0, 0, 0, 0.4);
            padding: 12px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            overflow-y: auto;
            max-height: 90vh;
            width: 250px;
        }

        .toggle-button {
            display: flex;
            align-items: center;
            justify-content: flex-start;
            gap: 8px;
            padding: 8px 12px;
            background-color: #4a5568;
            border-radius: 9999px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            border: 2px solid transparent;
            font-size: 14px;
        }

        .toggle-button:hover {
            background-color: #6b7280;
        }

        .toggle-button.active {
            border-color: #48bb78;
            box-shadow: 0 0 0 2px #48bb78;
        }

        .color-swatch {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
        }

        .loading-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 10px;
            color: white;
            z-index: 20;
            text-align: center;
            display: none;
        }

        .loading-bar {
            width: 200px;
            height: 10px;
            background-color: #6b7280;
            border-radius: 5px;
            margin-top: 10px;
            overflow: hidden;
        }

        .loading-progress {
            height: 100%;
            background-color: #38a169;
            transition: width 0.1s;
        }

        .tooltip {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
            z-index: 10;
        }

        .controls-info {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 12px;
            text-align: center;
            margin-top: 10px;
            border: 1px solid #4a5568;
        }
    </style>
    <script async src="https://unpkg.com/es-module-shims@1.8.0/dist/es-module-shims.js"></script>
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.module.min.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/"
        }
      }
    </script>
</head>
<body>
    <div id="app-container">
        <div class="controls-container">
            <div id="button-grid" class="button-grid"></div>
            <div class="controls-info">
                Use mouse to Orbit, Pan, and Zoom
            </div>
        </div>
        <div id="viewer-container"></div>
        <div id="loading-overlay" class="loading-container">
            <div class="text-xl font-bold">Loading Models...</div>
            <div class="loading-bar">
                <div id="loading-progress-bar" class="loading-progress"></div>
            </div>
            <div id="loading-percentage" class="text-sm mt-2">0%</div>
        </div>
    </div>
    
    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // --- Global Variables and Setup ---
        let scene, camera, renderer, controls, ambientLight, directionalLight;

        const viewerContainer = document.getElementById('viewer-container');
        const buttonGrid = document.getElementById('button-grid');
        const loadingOverlay = document.getElementById('loading-overlay');
        const loadingProgressBar = document.getElementById('loading-progress-bar');
        const loadingPercentage = document.getElementById('loading-percentage');

        const loadedModels = new Map();

        const gltfModels = [
            { id: 1, name: "1s", path: "https://sharoonsardar26-hue.github.io/3D-Models/1s.glb", color: "#BC2A32FF" },
            { id: 2, name: "2s", path: "https://sharoonsardar26-hue.github.io/3D-Models/2s.glb", color: "#E416E7FF" },
            { id: 3, name: "2px", path: "https://sharoonsardar26-hue.github.io/3D-Models/2px.glb", color: "#25E70AFF" },
            { id: 4, name: "2py", path: "https://sharoonsardar26-hue.github.io/3D-Models/2py.glb", color: "#25E70AFF" },
            { id: 5, name: "2pz", path: "https://sharoonsardar26-hue.github.io/3D-Models/2pz.glb", color: "#25E70AFF" },
            { id: 6, name: "3s", path: "https://sharoonsardar26-hue.github.io/3D-Models/3s.glb", color: "#0A3059FF" },
            { id: 7, name: "3px", path: "https://sharoonsardar26-hue.github.io/3D-Models/3px.glb", color: "#E4E70EFF" },
            { id: 8, name: "3py", path: "https://sharoonsardar26-hue.github.io/3D-Models/3py.glb", color: "#E4E70EFF" },
            { id: 9, name: "3pz", path: "https://sharoonsardar26-hue.github.io/3D-Models/3pz.glb", color: "#E4E70EFF" },
            { id: 10, name: "3dz2", path: "https://sharoonsardar26-hue.github.io/3D-Models/3dz2.glb", color: "#FF141BFF" },
            { id: 11, name: "3dxy", path: "https://sharoonsardar26-hue.github.io/3D-Models/3dxy.glb", color: "#E77E1CFF" },
            { id: 12, name: "3dxz", path: "https://sharoonsardar26-hue.github.io/3D-Models/3dxz.glb", color: "#E77E1CFF" },
            { id: 13, name: "3dyz", path: "https://sharoonsardar26-hue.github.io/3D-Models/3dyz.glb", color: "#E77E1CFF" },
            { id: 14, name: "3dx2-y2", path: "https://sharoonsardar26-hue.github.io/3D-Models/3dx2-y2.glb", color: "#E77E1CFF" },
            { id: 15, name: "4s", path: "https://sharoonsardar26-hue.github.io/3D-Models/4s.glb", color: "#FFFFFFFF" },
            { id: 16, name: "4px", path: "https://sharoonsardar26-hue.github.io/3D-Models/4px.glb", color: "#1AFFFDFF" },
            { id: 17, name: "4py", path: "https://sharoonsardar26-hue.github.io/3D-Models/4py.glb", color: "#1AFFFDFF" },
            { id: 18, name: "4pz", path: "https://sharoonsardar26-hue.github.io/3D-Models/4pz.glb", color: "#1AFFFDFF" },
            { id: 19, name: "4dz2", path: "https://sharoonsardar26-hue.github.io/3D-Models/4dz2.glb", color: "#2009FFFF" },
            { id: 20, name: "4dxy", path: "https://sharoonsardar26-hue.github.io/3D-Models/4dxy.glb", color: "#E708FFFF" },
            { id: 21, name: "4dxz", path: "https://sharoonsardar26-hue.github.io/3D-Models/4dxz.glb", color: "#E708FFFF" },
            { id: 22, name: "4dyz", path: "https://sharoonsardar26-hue.github.io/3D-Models/4dyz.glb", color: "#E708FFFF" },
            { id: 23, name: "4dx2-y2", path: "https://sharoonsardar26-hue.github.io/3D-Models/4dx2-y2.glb", color: "#E708FFFF" },
            { id: 24, name: "4fz2", path: "https://sharoonsardar26-hue.github.io/3D-Models/4fz2.glb", color: "#FF0F12FF" },
            { id: 25, name: "4fxy", path: "https://sharoonsardar26-hue.github.io/3D-Models/4fxy.glb", color: "#FFF50AFF" },
            { id: 26, name: "4fxy-1", path: "https://sharoonsardar26-hue.github.io/3D-Models/4fxy-1.glb", color: "#FFF50AFF" },
            { id: 27, name: "4fxz", path: "https://sharoonsardar26-hue.github.io/3D-Models/4fxz.glb", color: "#FFF50AFF" },
            { id: 28, name: "4fyz", path: "https://sharoonsardar26-hue.github.io/3D-Models/4fyz.glb", color: "#FFF50AFF" },
            { id: 29, name: "4fxyz", path: "https://sharoonsardar26-hue.github.io/3D-Models/4fxyz8.glb", color: "#371CFFFF" },
            { id: 30, name: "4fxyz-1", path: "https://sharoonsardar26-hue.github.io/3D-Models/4fxyz8-1.glb", color: "#371CFFFF" },
        ];


        // Initial setup function
        function init() {
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x2d3748);

            // Camera
            camera = new THREE.PerspectiveCamera(75, viewerContainer.clientWidth / viewerContainer.clientHeight, 0.1, 5000);
            camera.position.set(2, 2, 2);

            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(viewerContainer.clientWidth, viewerContainer.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.0;
            viewerContainer.appendChild(renderer.domElement);

            // Orbit Controls
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.screenSpacePanning = false;
            controls.minDistance = 1;
            controls.maxDistance = 150;
            controls.target.set(0, 0.5, 0);

            // Lights
            ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);

            directionalLight = new THREE.DirectionalLight(0xffffff, 1.0);
            directionalLight.position.set(5, 5, 5);
            scene.add(directionalLight);

            // Floor with Gridlines
            const gridHelper = new THREE.GridHelper(100, 100, 0x5a67d8, 0x4a5568);
            scene.add(gridHelper);

            // --- Custom Axes for X, Y, and Z ---
            // X-axis (Red)
            const axesMaterialRed = new THREE.LineBasicMaterial({ color: 0xff0000 });
            const axesGeometryX = new THREE.BufferGeometry().setFromPoints([
                new THREE.Vector3(-100, 0, 0),
                new THREE.Vector3(100, 0, 0)
            ]);
            
            // Y-axis (Green)
            const axesMaterialGreen = new THREE.LineBasicMaterial({ color: 0x00ff00 });
            const axesGeometryY = new THREE.BufferGeometry().setFromPoints([
                new THREE.Vector3(0, -100, 0),
                new THREE.Vector3(0, 100, 0)
            ]);

            // Z-axis (Blue)
            const axesMaterialBlue = new THREE.LineBasicMaterial({ color: 0x0000ff });
            const axesGeometryZ = new THREE.BufferGeometry().setFromPoints([
                new THREE.Vector3(0, 0, -100),
                new THREE.Vector3(0, 0, 100)
            ]);
            
            const axesX = new THREE.Line(axesGeometryX, axesMaterialRed);
            const axesY = new THREE.Line(axesGeometryY, axesMaterialGreen);
            const axesZ = new THREE.Line(axesGeometryZ, axesMaterialBlue);
            
            scene.add(axesX);
            scene.add(axesY);
            scene.add(axesZ);

            // --- UI Setup ---
            createModelButtons();
            
            // --- Model Loading ---
            loadAllModels();

            // Window resize handler
            window.addEventListener('resize', onWindowResize);

            // Initial render
            animate();
        }

        // --- Functions ---
        function onWindowResize() {
            camera.aspect = viewerContainer.clientWidth / viewerContainer.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(viewerContainer.clientWidth, viewerContainer.clientHeight);
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
        
        function createModelButtons() {
            gltfModels.forEach(model => {
                const button = document.createElement('button');
                button.className = 'toggle-button';
                button.dataset.modelId = model.id;
                button.innerHTML = `
                    <div class="color-swatch" style="background-color: ${model.color};"></div>
                    <span>${model.name}</span>
                `;
                buttonGrid.appendChild(button);

                button.addEventListener('click', () => {
                    const loadedModel = loadedModels.get(model.id);
                    if (loadedModel) {
                        loadedModel.visible = !loadedModel.visible;
                        button.classList.toggle('active', loadedModel.visible);
                    }
                });
            });
        }
        
        async function loadAllModels() {
            loadingOverlay.style.display = 'flex';
            let loadedCount = 0;
            const totalModels = gltfModels.length;

            const loader = new GLTFLoader();

            for (const model of gltfModels) {
                try {
                    const gltf = await loader.loadAsync(model.path);
                    const loadedModel = gltf.scene;
                    loadedModel.visible = false;
                    loadedModel.name = `model-${model.id}`;
                    scene.add(loadedModel);
                    loadedModels.set(model.id, loadedModel);
                    
                    loadedCount++;
                    const percentage = (loadedCount / totalModels) * 100;
                    loadingProgressBar.style.width = `${percentage}%`;
                    loadingPercentage.textContent = `${Math.round(percentage)}%`;
                    
                    if (model.id === 1) {
                        loadedModel.visible = true;
                        const button = buttonGrid.querySelector(`[data-model-id='1']`);
                        if (button) {
                            button.classList.add('active');
                        }
                    }

                } catch (error) {
                    console.error(`Error loading model ${model.name}:`, error);
                }
            }

            loadingOverlay.style.display = 'none';
        }

        window.onload = init;
    </script>
</body>
</html>
